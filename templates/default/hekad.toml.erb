# Generated by Chef
# <%= node['fqdn'] %>

[auth_log]
Type = "LogfileInput"
logfile = "/var/log/auth.log"
decoders = [ "syslog_decoder" ]
hostname = "<%= node['fqdn'] %>"
seekjournal = "/var/cache/hekad/seekjournals/_var_log_auth_log"

[syslog_decoder]
type = "PayloadRegexDecoder"
match_regex = '^(?P<Timestamp>\w+\s+\d+ \d+:\d+:\d+) (?P<Host>\S+) (?P<Program>\w+)\[?(?P<PID>\d+)?\]?:'
timestamp_layout= 'Jan _2 15:04:05'
timestamp_location = 'America/Los_Angeles'

[syslog_decoder.message_fields]
Type = "SyslogLog"
Host = "%Host%"
Program = "%Program%"
PID = "%PID%"

[AMQPOutput]
url = "amqp://logz.seb.safaribooks.com/"
exchange = "SyslogLogs"
exchangeType = "fanout"
message_matcher = "Type == 'SyslogLog'"
